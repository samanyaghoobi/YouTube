
# آموزش نصب و راه‌اندازی سرور V2Ray با پنل مرزبان در ۱۰ دقیقه

سلام دوستان! 👋 امروز قصد داریم در کمتر از ۱۰ دقیقه، یک سرور V2Ray را با استفاده از پنل مرزبان راه‌اندازی کنیم. آماده‌اید؟ بزن بریم! 🚀

## پیش‌نیازها

قبل از شروع، مطمئن شوید که موارد زیر را در اختیار دارید:

- **یک سرور مجازی (VPS)** با سیستم‌عامل اوبونتو
- **دسترسی به ترمینال** و آشنایی اولیه با دستورات لینوکس
- **یک دامنه یا زیردامنه** برای تنظیمات SSL

## مرحله ۱: اتصال به سرور

ابتدا با استفاده از SSH به سرور خود متصل شوید:

```bash
ssh username@your_server_ip
```

> **نکته:** `username` و `your_server_ip` را با اطلاعات کاربری و آی‌پی سرور خود جایگزین کنید.

## مرحله ۲: به‌روزرسانی و نصب پیش‌نیازها

در این مرحله، مخازن را به‌روزرسانی کرده و پیش‌نیازها را نصب کنید:

```bash
sudo apt update && sudo apt upgrade -y  # اجرای upgrade اجباری نیست، اما توصیه می‌شود.
sudo apt install -y curl
```

## مرحله ۳: دریافت و تنظیم SSL (در صورت نیاز به دسترسی امن)

اگر قصد دارید از دسترسی HTTPS استفاده کنید، می‌توانید با دنبال کردن یک راهنمای جداگانه، SSL را از Cloudflare دریافت و تنظیم کنید. این مرحله برای افزایش امنیت و محافظت از اطلاعات مهم است.

## مرحله ۴: نصب پنل مرزبان

برای نصب پنل مرزبان، اسکریپت زیر را اجرا کنید:

```bash
sudo bash -c "$(curl -sL https://github.com/Gozargah/Marzban-scripts/raw/master/marzban.sh)" @ install
```

> **نکته:** این دستور ممکن است چند دقیقه طول بکشد، لطفاً صبور باشید.

### رفع مشکلات احتمالی:

- **مشکل `docker-compose`:**

  اگر با خطای `docker-compose` مواجه شدید، دستور زیر را اجرا کنید:

  ```bash
  sudo apt install docker-compose
  ```

- **مشکل اتصال به Docker (برای سرورهای ایرانی):**

  اگر با مشکل اتصال به Docker مواجه شدید، مراحل زیر را دنبال کنید:

  ```bash
  sudo apt install docker.io
  ```

  سپس فایل تنظیمات Docker را به‌روزرسانی کنید:

  ```bash
  sudo bash -c 'cat > /etc/docker/daemon.json <<EOF
  {
    "insecure-registries" : ["https://docker.arvancloud.ir"],
    "registry-mirrors": ["https://docker.arvancloud.ir"]
  }
  EOF'
  ```

  و در نهایت، Docker را مجدداً راه‌اندازی کنید:

  ```bash
  docker logout
  sudo systemctl restart docker
  ```

  پس از این، می‌توانید مجدداً مرحله نصب پنل را انجام دهید.

## مرحله ۵: ایجاد کاربر ادمین

بعد از نصب، برای مدیریت پنل نیاز است یک کاربر ادمین با دسترسی روت ایجاد کنید:

```bash
marzban cli admin create --sudo
```

> **نکته:** حتماً نام کاربری و رمز عبور را یادداشت کنید.

## مرحله ۶: دسترسی به پنل

در نسخه‌های جدید مرزبان، برای دسترسی به پنل حتماً باید SSL داشته باشید. برای دور زدن این نیاز و دسترسی به پنل، ابتدا یک اتصال SSH به سرور ایجاد کنید:

```bash
ssh -L 8000:localhost:8000 user@server
```

سپس می‌توانید از طریق مرورگر به آدرس زیر مراجعه کنید:

```
http://localhost:8000/dashboard/login
```

> **نکته:** به جای `user@server`، اطلاعات کاربری و آدرس سرور خود را وارد کنید.

## جمع‌بندی

تبریک می‌گم! 🎉 شما با موفقیت یک سرور V2Ray را با پنل مرزبان راه‌اندازی کردید و دسترسی ایمن به پنل را تنظیم نمودید. اکنون می‌توانید از اینترنت با امنیت و سرعت بالا لذت ببرید. اگر سوالی داشتید، حتماً در بخش نظرات بپرسید.

تا راهنمای بعدی، خداحافظ! 👋